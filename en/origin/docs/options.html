<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type' />
    <meta content='A Ruby DSL for building MongoDB queries' name='description' />
    <meta content='mongoid, origin, mongodb, ruby, rails, odm, durran jordan' name='keywords' />
    <!--[if lt IE 9]>
  <script src='http://html5shiv.googlecode.com/svn/trunk/html5.js'></script>
<![endif]-->
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0' name='viewport' />
<link href="/stylesheets/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/bootstrap-responsive.min.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/mongoid.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/mongoid-coderay.css" media="screen" rel="stylesheet" type="text/css" />
<script src="/javascripts/jquery-1.8.1.min.js" type="text/javascript"></script>
<script src="/javascripts/bootstrap-dropdown.js" type="text/javascript"></script>
<script src="/javascripts/bootstrap-scrollspy.js" type="text/javascript"></script>
<script src="/javascripts/bootstrap-tooltip.js" type="text/javascript"></script>
<script src="/javascripts/mongoid.js" type="text/javascript"></script>
<title>Origin: Options</title>
  </head>
  <body data-offset='100' data-spy='scroll-spy' data-target='.page-nav'>
    <div class='origin' id='header'>
      <div class='navbar navbar-inverse navbar-fixed-top'>
        <div class='navbar-inner'>
          <div class='container'>
            <ul class='nav'>
              <li class='link'>
                            <a title="Mongoid" href="/en/mongoid/"><img src="/images/mongoid-logo-small-white.png" />
                </a>
    
              </li>
              <li class='link'>
                            <a title="Origin" href="/en/origin/"><img src="/images/origin-logo-small-green.png" />
                </a>
    
              </li>
              <li class='link'>
                            <a title="Moped" href="/en/moped/"><img src="/images/moped-logo-small-white.png" />
                </a>
    
              </li>
            </ul>
            <div class='logo-text'>
              origin
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id='navigation'>
      <div class='subnav'>
        <div class='container'>
          <ul class='nav nav-pills origin'>
            <li><a href="/en/origin/">HOME</a></li>
            <li class='dropdown' id='docs'>
              <a class='dropdown-toggle' data-toggle='dropdown' href='#docs'>
                DOCS
                <b class='caret'></b>
              </a>
              <ul class='dropdown-menu'>
                <li><a href="/en/origin/docs/installation.html">Installation</a></li>
                <li><a href="/en/origin/docs/selection.html">Selection</a></li>
                <li><a href="/en/origin/docs/options.html">Options</a></li>
                <li><a href="/en/origin/docs/serialization.html">Serialization</a></li>
                <li><a href="/en/origin/docs/aliases.html">Aliases</a></li>
              </ul>
            </li>
            <li><a href="/en/origin/links.html">LINKS</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div id='content'>
      <div class='container'>
        <h1>Options</h1>
<p>
  Origin provides a DSL on the queryable for building options to go along
  with the standard queries. The options hash can always be accessed from
  a queryable by calling <code>Queryable#options</code>.
</p>
<div class='page-nav'>
  <div class='container'>
    <ul class='nav nav-pills'>
      <li><a href="#standard">Standard</a></li>
      <li><a href="#sorting">Sorting</a></li>
    </ul>
  </div>
</div>
<section id='standard'>
  <h2>Standard</h2>
  <p>
    The following is a table of all options operations and their corresponding
    MongoDB options hash.
  </p>
  <table class='table table-bordered table-striped'>
    <thead>
      <tr>
        <th>Operation</th>
        <th>Origin</th>
        <th>Options</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class='doc'>
          <code>Queryable#batch_size</code>
          <p class='doc'>
            <i>
              Changes the number of documents that are returned by the
              cursor at a time.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.batch_size(<span class="integer">1000</span>)</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ batch_size: <span class="integer">1000</span> }</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#hint</code>
          <p class='doc'>
            <i>
              Adds a hint for which index (or not) to use in the query.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.hint(<span class="string"><span class="delimiter">&quot;</span><span class="content">$natural</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">1</span>)</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ hint: { <span class="string"><span class="delimiter">&quot;</span><span class="content">$natural</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">1</span> }}</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#limit</code>
          <p class='doc'>
            <i>
              Limit the number of returned documents.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.limit(<span class="integer">100</span>)</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ limit: <span class="integer">100</span> }</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#max_scan</code>
          <p class='doc'>
            <i>
              Limit the number of scanned documents in the query.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.max_scan(<span class="integer">100</span>)</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ max_scan: <span class="integer">100</span> }</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#no_timeout</code>
          <p class='doc'>
            <i>
              Tell the query not to timeout.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.no_timeout</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ timeout: <span class="predefined-constant">false</span> }</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#only</code>
          <p class='doc'>
            <i>
              Limit the fields that are returned to the provided fields.
              Note that you can only include fields (with <code>only</code>)
              or exclude fields (with <code>without</code>) but not a
              combination of both.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.only(<span class="symbol">:name</span>, <span class="symbol">:age</span>)</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ fields: { <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">1</span> }}</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#skip</code>
          <p class='doc'>
            <i>
              Skip the provided number of documents.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.skip(<span class="integer">100</span>)</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ skip: <span class="integer">100</span> }</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#slice</code>
          <p class='doc'>
            <i>
              Limit the number of elements in embedded arrays that are
              returned.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.slice(aliases: [ <span class="integer">0</span>, <span class="integer">5</span> ])</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ aliases: { <span class="string"><span class="delimiter">&quot;</span><span class="content">$slice</span><span class="delimiter">&quot;</span></span> =&gt; [ <span class="integer">0</span>, <span class="integer">5</span> ] }}</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#snapshot</code>
          <p class='doc'>
            <i>
              Set the option to execute the query in snapshot mode.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.snapshot</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ snapshot: <span class="predefined-constant">true</span> }</pre></div>
          </div>
        </td>
      </tr>
      <tr>
        <td class='doc'>
          <code>Queryable#without</code>
          <p class='doc'>
            <i>
              Limit the fields that are returned everything except the
              provided fields.  Note that you can only include fields
              (with <code>only</code>) or exclude fields
              (with <code>without</code>) but not a combination of both.
            </i>
          </p>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>queryable.without(<span class="symbol">:name</span>, <span class="symbol">:age</span>)</pre></div>
          </div>
        </td>
        <td>
          <div class="CodeRay">
            <div class="code"><pre>{ fields: { <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">-1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">-1</span> }}&#x000A;</pre></div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</section>
<section id='sorting'>
  <h2>Sorting</h2>
  <p>
    Origin's sorting syntax is special in that there are many different
    ways to add sorting criteria, and the underlying options can be
    configured to change depending on which driver you are using. You
    can mix and match ascending and descending in different styles if
    your heart desires.
  </p>
  <h3>Sort Ascending</h3>
  <p>
    There are a few different ways to sort fields in ascending order.
    Choose the syntax you like the best.
  </p>
  <div class="CodeRay">
    <div class="code"><pre>queryable.asc(<span class="symbol">:first_name</span>, <span class="symbol">:last_name</span>)&#x000A;queryable.order_by(<span class="symbol">:first_name</span>.asc, <span class="symbol">:last_name</span>.asc)&#x000A;queryable.order_by(<span class="string"><span class="delimiter">&quot;</span><span class="content">first_name ASC, last_name ASC</span><span class="delimiter">&quot;</span></span>)&#x000A;queryable.order_by(first_name: <span class="integer">1</span>, last_name: <span class="integer">1</span>)&#x000A;queryable.order_by(first_name: <span class="string"><span class="delimiter">&quot;</span><span class="content">asc</span><span class="delimiter">&quot;</span></span>, last_name: <span class="string"><span class="delimiter">&quot;</span><span class="content">asc</span><span class="delimiter">&quot;</span></span>)&#x000A;queryable.order_by(first_name: <span class="symbol">:asc</span>, last_name: <span class="symbol">:asc</span>)&#x000A;queryable.order_by([[ <span class="symbol">:first_name</span>, <span class="integer">1</span> ], [ <span class="symbol">:last_name</span>, <span class="integer">1</span> ]])&#x000A;queryable.order_by([[ <span class="symbol">:first_name</span>, <span class="symbol">:asc</span> ], [ <span class="symbol">:last_name</span>, <span class="symbol">:asc</span> ]])&#x000A;</pre></div>
  </div>
  <p>
    All of the previous calls translate to the following options:
  </p>
  <div class="CodeRay">
    <div class="code"><pre>{ sort: { <span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last_name</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">1</span> }}&#x000A;</pre></div>
  </div>
  <h3>Sort Descending</h3>
  <p>
    There are a few different ways to sort fields in descending order.
    Choose the syntax you like the best.
  </p>
  <div class="CodeRay">
    <div class="code"><pre>queryable.desc(<span class="symbol">:first_name</span>, <span class="symbol">:last_name</span>)&#x000A;queryable.order_by(<span class="symbol">:first_name</span>.desc, <span class="symbol">:last_name</span>.desc)&#x000A;queryable.order_by(<span class="string"><span class="delimiter">&quot;</span><span class="content">first_name DESC, last_name DESC</span><span class="delimiter">&quot;</span></span>)&#x000A;queryable.order_by(first_name: <span class="integer">-1</span>, last_name: <span class="integer">-1</span>)&#x000A;queryable.order_by(first_name: <span class="string"><span class="delimiter">&quot;</span><span class="content">desc</span><span class="delimiter">&quot;</span></span>, last_name: <span class="string"><span class="delimiter">&quot;</span><span class="content">desc</span><span class="delimiter">&quot;</span></span>)&#x000A;queryable.order_by(first_name: <span class="symbol">:desc</span>, last_name: <span class="symbol">:desc</span>)&#x000A;queryable.order_by([[ <span class="symbol">:first_name</span>, <span class="integer">-1</span> ], [ <span class="symbol">:last_name</span>, <span class="integer">-1</span> ]])&#x000A;queryable.order_by([[ <span class="symbol">:first_name</span>, <span class="symbol">:desc</span> ], [ <span class="symbol">:last_name</span>, <span class="symbol">:desc</span> ]])&#x000A;</pre></div>
  </div>
  <p>
    All of the previous calls translate to the following options:
  </p>
  <div class="CodeRay">
    <div class="code"><pre>{ sort: { <span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">-1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">last_name</span><span class="delimiter">&quot;</span></span> =&gt; <span class="integer">-1</span> }}&#x000A;</pre></div>
  </div>
  <h3>Changing Driver Syntax</h3>
  <p>
    By default the sorting syntax is for Moped. If you are using the
    10gen driver by itself, then when creating the queryable tell it
    to use 10gen's syntax by passing <code>:mongo</code> as the third
    argument to the queryable constructor.
  </p>
  <div class="CodeRay">
    <div class="code"><pre>queryable = <span class="constant">Query</span>.new({}, {}, <span class="symbol">:mongo</span>)&#x000A;queryable = queryable.order_by([[ <span class="symbol">:first_name</span>, <span class="symbol">:desc</span> ], [ <span class="symbol">:last_name</span>, <span class="symbol">:desc</span> ]])&#x000A;queryable.options <span class="comment">#=&gt; { sort: [[ &quot;first_name&quot;, -1 ], [ &quot;last_name&quot;, -1 ]]}</span></pre></div>
  </div>
</section>
      </div>
    </div>
  </body>
</html>
